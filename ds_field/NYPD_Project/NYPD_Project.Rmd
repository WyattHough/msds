---
title: "NYPD Project"
author: "W. Hough"
date: "2022-09-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Import and Inspect Data

Import required packages
```{r, message=FALSE}
library("tidyverse")
library("lubridate")
```


The NYPD Shooting Incident Data (Historic) data set is imported from this site: https://catalog.data.gov/dataset
The data is cleaned during import to remove unknown data types and replace them with NA's.

```{r, message=FALSE}
na_strings <- c("UNKNOWN", "U", "", "1020", "940", "224")
nypd_data <- read_csv("https://data.cityofnewyork.us/api/views/833y-fsy8/rows.csv?accessType=DOWNLOAD", na = na_strings)
summary(nypd_data)
```
## Tidying
We will tidy the data set by removing columns we are uninterested in and adjusting the date format.

First we will use BORO as our location groupings because the general public will understand these locations better than the numbers indicated by the other columns. Therefore, we will remove the other columns related to location. (If we were to present this to law enforcement, then we could perform the following analyses on tighter location bounds)

Next we will convert the date strings into datetime objects.
```{r}
nypd_data_adjusted <- nypd_data %>% 
  select(-c(PRECINCT, JURISDICTION_CODE, X_COORD_CD, Y_COORD_CD, Latitude, Longitude, Lon_Lat)) %>%
  mutate(OCCUR_DATE = mdy(OCCUR_DATE)) %>%
  rename(DATE = OCCUR_DATE, TIME = OCCUR_TIME)
summary(nypd_data_adjusted)
```

Lets see what the BORO locations are and what the age, sex, and race groups are.

```{r}
writeLines("Boro")
unique(nypd_data_adjusted$BORO)
writeLines("\nAge Groups")
union(nypd_data_adjusted$PERP_AGE_GROUP, nypd_data_adjusted$VIC_AGE_GROUP)
writeLines("\nRace")
union(nypd_data_adjusted$PERP_RACE, nypd_data_adjusted$VIC_RACE)
writeLines("\nSex")
union(nypd_data_adjusted$PERP_SEX, nypd_data_adjusted$VIC_SEX)


```

## Visualize the data

The first visualization will display the total murders per region. The data set is generated by grouping the data by Boro and summing the number of murders there were and dividing that by the number of shootings there were.

```{r}
shooting_by_region <- nypd_data_adjusted %>%
  group_by(BORO) %>%
  ungroup()
```

Generate a bar graph to display the total murders by region.
```{r}
shooting_by_region %>%
  ggplot(aes(x = BORO, y = STATISTICAL_MURDER_FLAG)) +
  geom_col()
```
## Analysis and more Visualization

The data shows that there are more murders in Brooklyn as compared to the other regions in NYC with Bronx being second. This leads us to wonder how many total shootings there are.
```{r}
murders_per_shooting <- nypd_data_adjusted %>%
  group_by(BORO) %>%
  summarize(murders_per_shoot = sum(STATISTICAL_MURDER_FLAG) / nrow(BORO)) %>%
  ungroup()
```

```{r}
murders_per_shooting %>%
  ggplot(aes(x = BORO, y = murders_per_shoot)) +
  geom_col()
```
This chart shows that almost 8% of shootings in Brooklyn are murders while 
